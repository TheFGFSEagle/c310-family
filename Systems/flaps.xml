<?xml version="1.0" encoding="UTF-8"?>
<system name="flaps">
	<channel name="Flaps">
		<switch name="systems/flaps/actuator-cmd">
			<name>Flap actuator command</name>
			<default value="0"/>
			<test logic="AND" value="/controls/flight/flaps">
				fcs/flap-pos-norm GT 0
				fcs/flap-pos-norm LT 1
				/systems/electrical/consumers/flaps-motor/volts GT 12
			</test>
		</fcs_function>
		
		<fcs_function name="systems/flaps/actuator-rate">
			<name>Flap actuator rate</name>
			<function>
				<product>
					<property>systems/flaps/actuator-cmd</property>
					<quotient>
						<property>/systems/electrical/consumers/flaps-motor/amps</property>
						<property>/systems/electrical/consumers/flaps-motor/rated-amps</property>
					</quotient>
					<!-- 5Â° degrees flaps movement per sec - gives 9 secs for full extension -->
					<value>5</value>
				</product>
			</function>
		</fcs_function>
		
		<fcs_function name="fcs/flap-pos-deg">
			<name>Flap actuator</name>
			<function>
				<sum>
					<property>fcs/flap-pos-deg</property>
					<product>
						<property>systems/flaps/actuator-rate</property>
						<property>simulation/channel-dt</property>
					</product>
				</sum>
			</function>
			<clipto>
				<min>0</min>
				<max>45</max>
			</clipto>
			<output>/surface-positions/flaps-deg</output>
		</fcs_function>
		
		<aerosurface_scale name="fcs/flap-pos-norm">
			<name>Flap position normalized</name>
			<input>fcs/flap-pos-deg</input>
			<domain>
				<min>0</min>
				<max>45</max>
			</domain>
			<range>
				<min>0</min>
				<max>1</max>
			</range>
			<output></output>
		</aerosurface_scale>
	</channel>
</system>
