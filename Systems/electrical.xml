<?xml version="1.0"?>
<!--
	Electrical system for the C310B, by TheEagle, started in November 2022
	
	Technical data:
		Batteries (2, wired in series to produce 24 V):
			Capacity: 24 Ah
			Voltage: 12 V
			Current: 35 (?) A
			Type: Lead-acid
		Alternators (2):
			standard:
				Voltage: 24 V
				Current: 35 A
			optional:
				Voltage: 24V
				Current: 50 A
		Ground power:
			Voltage: 24 (?) V
			Current 100 (?) A
		System:
			Voltage: 24 V
			Type: Direct current
-->
<PropertyList>
	<property-root>/systems/electrical</property-root>
	
	<!-- Alternators -->
	<filter>
		<name>Available left alternator amps</name>
		<type>gain</type>
		<input>
			<condition>
				<greater-than-equals>
					<property>/engines/engine[0]/rpm</property>
					<value>133</value>
				</greater-than-equals>
				<property>/engines/engine[0]/running</property>
			</condition>
			<!-- graph of this formula: https://www.desmos.com/calculator/z8p9ddnltl where A = alternator/rated-amps -->
			<expression>
				<prod>
					<dif>
						<prod>
							<value>30.811</value>
							<log>
								<dif>
									<prod>
										<property>/engines/engine[0]/rpm</property>
										<value>10</value>
									</prod>
									<value>1300</value>
								</dif>
							</log>
						</prod>
						<value>98.1</value>
					</dif>
					<div>
						<property>suppliers/alternator[0]/rated-amps</property>
						<value>172</value>
					</div>
					<property>/controls/engines/engine[0]/master-alt</property>
					<property>/controls/circuit-breakers/left-alternator/closed</property>
				</prod>
			</expression>
		</input>
		<output>suppliers/alternator[0]/available-amps</output>
		<min>0</min>
		<max>suppliers/alternator[0]/rated-amps</max>
	</filter>
	<filter>
		<name>Available left alternator volts</name>
		<type>gain</type>
		<input>
			<condition>
				<property>/engines/engine[0]/running</property>
			</condition>
			<expression>
				<product>
					<property>/engines/engine[0]/rpm</property>
					<value>0.07</value>
					<div>
						<property>suppliers/alternator[0]/rated-amps</property>
						<max>
							<property>suppliers/alternator[0]/amps</property>
							<value>1</value>
						</max>
					</div>
					<property>/controls/engines/engine[0]/master-alt</property>
					<property>/controls/circuit-breakers/left-alternator/closed</property>
				</product>
			</expression>
		</input>
		<output>suppliers/alternator[0]/volts</output>
		<min>0</min>
		<max>suppliers/alternator[0]/rated-volts</max>
	</filter>
	<filter>
		<name>Available right alternator amps</name>
		<type>gain</type>
		<input>
			<condition>
				<greater-than-equals>
					<property>/engines/engine[1]/rpm</property>
					<value>133</value>
				</greater-than-equals>
				<property>/engines/engine[1]/running</property>
			</condition>
			<!-- graph of this formula: https://www.desmos.com/calculator/z8p9ddnltl where A = alternator/rated-amps -->
			<expression>
				<prod>
					<dif>
						<prod>
							<value>30.811</value>
							<log>
								<dif>
									<prod>
										<property>/engines/engine[1]/rpm</property>
										<value>10</value>
									</prod>
									<value>1300</value>
								</dif>
							</log>
						</prod>
						<value>98.1</value>
					</dif>
					<div>
						<property>suppliers/alternator[1]/rated-amps</property>
						<value>172</value>
					</div>
					<property>/controls/engines/engine[1]/master-alt</property>
					<property>/controls/circuit-breakers/right-alternator/closed</property>
				</prod>
			</expression>
		</input>
		<output>suppliers/alternator[1]/available-amps</output>
		<min>0</min>
		<max>suppliers/alternator[1]/rated-amps</max>
	</filter>
	<filter>
		<name>Available right alternator volts</name>
		<type>gain</type>
		<input>
			<condition>
				<property>/engines/engine[1]/running</property>
			</condition>
			<expression>
				<product>
					<property>/engines/engine[1]/rpm</property>
					<value>0.07</value>
					<div>
						<property>suppliers/alternator[1]/rated-amps</property>
						<max>
							<property>suppliers/alternator[1]/amps</property>
							<value>1</value>
						</max>
					</div>
					<property>/controls/engines/engine[1]/master-alt</property>
					<property>/controls/circuit-breakers/right-alternator/closed</property>
				</product>
			</expression>
		</input>
		<output>suppliers/alternator[1]/volts</output>
		<min>0</min>
		<max>suppliers/alternator[1]/rated-volts</max>
	</filter>
	<filter>
		<name>Available alternators amps</name>
		<type>gain</type>
		<input>
			<expression>
				<sum>
					<property>suppliers/alternator[0]/available-amps</property>
					<property>suppliers/alternator[1]/available-amps</property>
				</sum>
			</expression>
		</input>
		<output>suppliers/alternators/available-amps</output>
	</filter>
	
	<!-- Ground power -->
	<filter>
		<name>Available ground power amps</name>
		<type>gain</type>
		<gain>suppliers/gpu/rated-amps</gain>
		<input>
			<property>/controls/electric/ground-power-connected</property>
			<scale>/controls/electric/battery-switch</scale>
		</input>
		<output>suppliers/gpu/available-amps</output>
	</filter>
	<filter>
		<name>Available ground power volts</name>
		<type>gain</type>
		<gain>/controls/electric/ground-power-connected</gain>
		<input>
			<expression>
				<product>
					<property>suppliers/gpu/rated-volts</property>
					<div>
						<property>suppliers/gpu/rated-amps</property>
						<max>
							<property>suppliers/gpu/amps</property>
							<value>1</value>
						</max>
					</div>
					<property>/controls/electric/battery-switch</property>
				</product>
			</expression>
		</input>
		<output>suppliers/gpu/volts</output>
		<min>0</min>
		<max>suppliers/gpu/rated-volts</max>
	</filter>
	
	<!-- Batteries -->
	<filter>
		<name>First battery output factor based on charge</name>
		<type>gain</type>
		<gain>/controls/electric/battery-switch</gain>
		<input>
			<expression>
				<div>
					<sum>
						<pow>
							<prod>
								<dif>
									<prod>
										<value>3</value>
										<dif>
											<value>1</value>
											<property>suppliers/battery[0]/charge-norm</property>
										</dif>
									</prod>
									<value>1</value>
								</dif>
								<value>-1</value>
							</prod>
							<value>5</value>
						</pow>
						<value>32</value>
					</sum>
					<value>32</value>
				</div>
			</expression>
		</input>
		<output>suppliers/battery[0]/available-power-factor</output>
	</filter>
	<filter>
		<name>Available first battery volts</name>
		<type>gain</type>
		<gain>suppliers/battery[0]/available-power-factor</gain>
		<input>
			<expression>
				<product>
					<property>suppliers/battery[0]/rated-volts</property>
					<div>
						<property>suppliers/battery[0]/rated-amps</property>
						<max>
							<property>suppliers/battery[0]/amps</property>
							<value>1</value>
						</max>
					</div>
					<property>/controls/electric/battery-switch</property>
				</product>
			</expression>
		</input>
		<output>suppliers/battery[0]/volts</output>
		<min>0</min>
		<max>suppliers/battery[0]/rated-volts</max>
	</filter>
	<filter>
		<name>Available first battery amps</name>
		<type>gain</type>
		<gain>suppliers/battery[0]/rated-amps</gain>
		<input>
			<property>suppliers/battery[0]/available-power-factor</property>
			<scale>/controls/electric/battery-switch</scale>
		</input>
		<output>suppliers/battery[0]/available-amps</output>
	</filter>
	<filter>
		<name>Second battery output factor based on charge</name>
		<type>gain</type>
		<gain>/controls/electric/battery-switch</gain>
		<input>
			<expression>
				<div>
					<sum>
						<pow>
							<prod>
								<dif>
									<prod>
										<value>3</value>
										<dif>
											<value>1</value>
											<property>suppliers/battery[1]/charge-norm</property>
										</dif>
									</prod>
									<value>1</value>
								</dif>
								<value>-1</value>
							</prod>
							<value>5</value>
						</pow>
						<value>32</value>
					</sum>
					<value>32</value>
				</div>
			</expression>
		</input>
		<output>suppliers/battery[1]/available-power-factor</output>
	</filter>
	<filter>
		<name>Available second battery volts</name>
		<type>gain</type>
		<gain>suppliers/battery[1]/available-power-factor</gain>
		<input>
			<expression>
				<product>
					<property>suppliers/battery[1]/rated-volts</property>
					<div>
						<property>suppliers/battery[1]/rated-amps</property>
						<max>
							<property>suppliers/battery[1]/amps</property>
							<value>1</value>
						</max>
					</div>
					<property>/controls/electric/battery-switch</property>
				</product>
			</expression>
		</input>
		<output>suppliers/battery[1]/volts</output>
		<min>0</min>
		<max>suppliers/battery[1]/rated-volts</max>
	</filter>
	<filter>
		<name>Available second battery amps</name>
		<type>gain</type>
		<gain>suppliers/battery[1]/rated-amps</gain>
		<input>
			<property>suppliers/battery[1]/available-power-factor</property>
			<scale>/controls/electric/battery-switch</scale>
		</input>
		<output>suppliers/battery[1]/available-amps</output>
	</filter>
	<filter>
		<name>Available batteries amps</name>
		<type>gain</type>
		<input>
			<expression>
				<sum>
					<property>suppliers/battery[0]/available-amps</property>
					<property>suppliers/battery[1]/available-amps</property>
				</sum>
			</expression>
		</input>
		<output>suppliers/batteries/available-amps</output>
	</filter>
		
	<filter>
		<name>Available battery volts</name>
		<type>gain</type>
		<input>
			<expression>
				<sum>
					<property>suppliers/battery[0]/volts</property>
					<property>suppliers/battery[1]/volts</property>
				</sum>
			</expression>
		</input>
		<output>suppliers/batteries/volts</output>
	</filter>
	<filter>
		<name>Available alternator volts</name>
		<type>gain</type>
		<input>
			<expression>
				<max>
					<property>suppliers/alternator[0]/volts</property>
					<property>suppliers/alternator[1]/volts</property>
				</max>
			</expression>
		</input>
		<output>suppliers/alternators/volts</output>
	</filter>
	
	<filter>
		<name>Bus available amps</name>
		<type>gain</type>
		<input>
			<expression>
				<sum>
					<property>suppliers/alternators/available-amps</property>
					<property>suppliers/gpu/available-amps</property>
				</sum>
			</expression>
		</input>
		<output>bus/available-amps</output>
	</filter>
	<filter>
		<name>Bus volts</name>
		<type>gain</type>
		<input>
			<expression>
				<max>
					<property>suppliers/alternators/volts</property>
					<property>suppliers/gpu/volts</property>
					<product>
						<property>suppliers/batteries/volts</property>
						<property>suppliers/batteries/contactor</property>
					</product>
				</max>
			</expression>
		</input>
		<output>
			<property>bus/volts</property>
			<property>volts</property>
		</output>
	</filter>
	
	<filter>
		<name>Clock backlight volts</name>
		<type>gain</type>
		<gain>/controls/circuit-breakers/red-inst-front-dome-baggage-light/closed</gain>
		<input>
			<condition>
				<equals>
					<property>/parts/selected-clock</property>
					<value>AT420100</value>
				</equals>
			</condition>
			<property>bus/volts</property>
			<scale>
				<property>/controls/lighting/red-instrument-norm</property>
			</scale>
		</input>
		<output>consumers/clock-backlight/volts</output>
	</filter>
	<filter>
		<name>Clock backlight amps</name>
		<type>gain</type>
		<input>
			<condition>
				<equals>
					<property>/parts/selected-clock</property>
					<value>AT420100</value>
				</equals>
			</condition>
			<expression>
				<div>
					<property>consumers/clock-backlight/volts</property>
					<div>
						<property>consumers/clock-backlight/rated-volts</property>
						<property>consumers/clock-backlight/rated-amps</property>
					</div>
				</div>
			</expression>
		</input>
		<output>consumers/clock-backlight/amps</output>
	</filter>
	
	<filter>
		<name>Clock volts</name>
		<type>gain</type>
		<input>
			<condition>
				<equals>
					<property>/parts/selected-clock</property>
					<value>AT420100</value>
				</equals>
			</condition>
			<property>bus/volts</property>
		</input>
		<output>consumers/clock/volts</output>
	</filter>
	<filter>
		<name>Clock amps</name>
		<type>gain</type>
		<input>
			<condition>
				<equals>
					<property>/parts/selected-clock</property>
					<value>AT420100</value>
				</equals>
			</condition>
			<expression>
				<div>
					<property>consumers/clock/volts</property>
					<div>
						<property>consumers/clock/rated-volts</property>
						<property>consumers/clock/rated-amps</property>
					</div>
				</div>
			</expression>
		</input>
		<output>consumers/clock/amps</output>
	</filter>
	
	<filter>
		<name>Nav lights volts</name>
		<type>gain</type>
		<gain>/controls/circuit-breakers/nav-lights-oil-dilution-primers/closed</gain>
		<input>
			<property>bus/volts</property>
			<scale>/controls/lighting/nav-lights</scale>
		</input>
		<output>consumers/nav-lights/volts</output>
	</filter>
	<filter>
		<name>Nav lights amps</name>
		<type>gain</type>
		<input>
			<expression>
				<div>
					<property>consumers/nav-lights/volts</property>
					<div>
						<property>consumers/nav-lights/rated-volts</property>
						<property>consumers/nav-lights/rated-amps</property>
					</div>
				</div>
			</expression>
		</input>
		<output>consumers/nav-lights/amps</output>
	</filter>
	
	<filter>
		<name>Left landing light volts</name>
		<type>gain</type>
		<gain>/controls/circuit-breakers/left-landing-light-front-cigar-lighter/closed</gain>
		<input>
			<property>bus/volts</property>
			<scale>
				<property>/controls/lighting/landing-light[0]</property>
				<min>0</min>
				<max>1</max>
			</scale>
		</input>
		<output>consumers/landing-light[0]/volts</output>
	</filter>
	<filter>
		<name>Left landing light amps</name>
		<type>gain</type>
		<input>
			<expression>
				<div>
					<property>consumers/landing-light[0]/volts</property>
					<div>
						<property>consumers/landing-light[0]/rated-volts</property>
						<property>consumers/landing-light[0]/rated-amps</property>
					</div>
				</div>
			</expression>
		</input>
		<output>consumers/landing-light[0]/amps</output>
	</filter>
	
	<logic>
		<name>Left UV instrument light active</name>
		<input>
			<or>
				<and>
					<property>/systems/electrical/consumers/uv-instrument-light[0]/active</property>
					<property>/systems/electrical/consumers/uv-instrument-light[0]/volts</property>
				</and>
				<and>
					<property>/controls/lighting/uv-instrument-starter-button-pressed[0]</property>
					<!-- To start the UV lights, the dimming rheostat needs to be turned to full intensity -->
					<greater-than>
						<property>/systems/electrical/consumers/uv-instrument-light[0]/volts</property>
						<value>20</value>
					</greater-than>
				</and>
			</or>
		</input>
		<output>/systems/electrical/consumers/uv-instrument-light[0]/active</output>
	</logic>
	<logic>
		<name>Right UV instrument light active</name>
		<input>
			<or>
				<and>
					<property>/systems/electrical/consumers/uv-instrument-light[1]/active</property>
					<property>/systems/electrical/consumers/uv-instrument-light[1]/volts</property>
				</and>
				<and>
					<property>/controls/lighting/uv-instrument-starter-button-pressed[1]</property>
					<!-- To start the UV lights, the dimming rheostat needs to be turned to full intensity -->
					<greater-than>
						<property>/systems/electrical/consumers/uv-instrument-light[1]/volts</property>
						<value>20</value>
					</greater-than>
				</and>
			</or>
		</input>
		<output>/systems/electrical/consumers/uv-instrument-light[1]/active</output>
	</logic>
	<logic>
		<name>Reset left UV instrument light starter button</name>
		<input>
			<value type="bool">false</value>
		</input>
		<output>/controls/lighting/uv-instrument-starter-button-pressed[0]</output>
	</logic>
	<logic>
		<name>Reset right UV instrument light starter button</name>
		<input>
			<value type="bool">false</value>
		</input>
		<output>/controls/lighting/uv-instrument-starter-button-pressed[1]</output>
	</logic>
	
	<filter>
		<name>UV instrument light volts</name>
		<type>gain</type>
		<gain>/controls/circuit-breakers/uv-inst-lights-rear-dome-light/closed</gain>
		<input>
			<property>bus/volts</property>
			<scale>
				<property>/controls/lighting/uv-instrument-norm</property>
				<min>0</min>
				<max>1</max>
			</scale>
		</input>
		<output>consumers/uv-instrument-light[0]/volts</output>
		<output>consumers/uv-instrument-light[1]/volts</output>
	</filter>
	<filter>
		<name>Left UV instrument light amps</name>
		<type>gain</type>
		<gain>/systems/electrical/consumers/uv-instrument-light[0]/active</gain>
		<input>
			<expression>
				<div>
					<property>consumers/uv-instrument-light[0]/volts</property>
					<div>
						<property>consumers/uv-instrument-light[0]/rated-volts</property>
						<property>consumers/uv-instrument-light[0]/rated-amps</property>
					</div>
				</div>
			</expression>
		</input>
		<output>consumers/uv-instrument-light[0]/amps</output>
	</filter>
	<filter>
		<name>Right UV instrument light amps</name>
		<type>gain</type>
		<gain>/systems/electrical/consumers/uv-instrument-light[1]/active</gain>
		<input>
			<expression>
				<div>
					<property>consumers/uv-instrument-light[1]/volts</property>
					<div>
						<property>consumers/uv-instrument-light[1]/rated-volts</property>
						<property>consumers/uv-instrument-light[1]/rated-amps</property>
					</div>
				</div>
			</expression>
		</input>
		<output>consumers/uv-instrument-light[1]/amps</output>
	</filter>
	
	<filter>
		<name>Red instrument light volts</name>
		<type>gain</type>
		<gain>/controls/circuit-breakers/red-inst-front-dome-baggage-light/closed</gain>
		<input>
			<property>bus/volts</property>
			<scale>
				<property>/controls/lighting/red-instrument-norm</property>
				<min>0</min>
				<max>1</max>
			</scale>
		</input>
		<output>consumers/red-instrument-light[0]/volts</output>
	</filter>
	<filter>
		<name>Red instrument light amps</name>
		<type>gain</type>
		<input>
			<expression>
				<div>
					<property>consumers/red-instrument-light/volts</property>
					<div>
						<property>consumers/red-instrument-light/rated-volts</property>
						<property>consumers/red-instrument-light/rated-amps</property>
					</div>
				</div>
			</expression>
		</input>
		<output>consumers/red-instrument-light/amps</output>
	</filter>
	
	<filter>
		<name>Front dome light volts</name>
		<type>gain</type>
		<gain>/controls/circuit-breakers/red-inst-front-dome-baggage-light/closed</gain>
		<input>
			<property>bus/volts</property>
			<scale>
				<property>/controls/lighting/front-dome</property>
				<min>0</min>
				<max>1</max>
			</scale>
		</input>
		<output>consumers/front-dome-light/volts</output>
	</filter>
	<filter>
		<name>Front dome light amps</name>
		<type>gain</type>
		<input>
			<expression>
				<div>
					<property>consumers/front-dome-light/volts</property>
					<div>
						<property>consumers/front-dome-light/rated-volts</property>
						<property>consumers/front-dome-light/rated-amps</property>
					</div>
				</div>
			</expression>
		</input>
		<output>consumers/front-dome-light/amps</output>
	</filter>
	<filter>
		<name>Stall warning horn volts</name>
		<type>gain</type>
		<!--<gain>/controls/circuit-breakers/uv-inst-lights-rear-dome-light/closed</gain>-->
		<input>
			<property>bus/volts</property>
		</input>
		<output>consumers/stall-warning-horn/volts</output>
	</filter>
	<filter>
		<name>Stall warning horn amps</name>
		<type>gain</type>
		<input>
			<expression>
				<product>
					<div>
						<property>consumers/stall-warning-horn/volts</property>
						<div>
							<property>consumers/stall-warning-horn/rated-volts</property>
							<property>consumers/stall-warning-horn/rated-amps</property>
						</div>
					</div>
					<property>/systems/stall-warning/horn-volume-norm</property>
				</product>
			</expression>
		</input>
		<output>consumers/stall-warning-horn/amps</output>
	</filter>
	<filter>
		<name>Stall warning indicator volts</name>
		<type>gain</type>
		<enable>
			<condition>
				<equals>
					<property>/parts/selected-stall-warning</property>
					<value>0511062-7</value>
				</equals>
			</condition>
		</enable>
		<!--<gain>/controls/circuit-breakers/uv-inst-lights-rear-dome-light/closed</gain>-->
		<input>
			<property>bus/volts</property>
		</input>
		<output>consumers/stall-warning-indicator/volts</output>
	</filter>
	<filter>
		<name>Stall warning indicator amps</name>
		<type>gain</type>
		<enable>
			<condition>
				<equals>
					<property>/parts/selected-stall-warning</property>
					<value>0511062-7</value>
				</equals>
			</condition>
		</enable>
		<input>
			<expression>
				<product>
					<div>
						<property>consumers/stall-warning-indicator/volts</property>
						<div>
							<property>consumers/stall-warning-indicator/rated-volts</property>
							<property>consumers/stall-warning-indicator/rated-amps</property>
						</div>
					</div>
					<property>/instrumentation/stall-warning/lamp-brightness-norm</property>
				</product>
			</expression>
		</input>
		<output>consumers/stall-warning-indicator/amps</output>
	</filter>
	
	<filter>
		<name>Rear dome light volts</name>
		<type>gain</type>
		<gain>/controls/circuit-breakers/uv-inst-lights-rear-dome-light/closed</gain>
		<input>
			<property>bus/volts</property>
			<scale>
				<property>/controls/lighting/rear-dome</property>
				<min>0</min>
				<max>1</max>
			</scale>
		</input>
		<output>consumers/rear-dome-light/volts</output>
	</filter>
	<filter>
		<name>Rear dome light amps</name>
		<type>gain</type>
		<input>
			<expression>
				<div>
					<property>consumers/rear-dome-light/volts</property>
					<div>
						<property>consumers/rear-dome-light/rated-volts</property>
						<property>consumers/rear-dome-light/rated-amps</property>
					</div>
				</div>
			</expression>
		</input>
		<output>consumers/rear-dome-light/amps</output>
	</filter>
	
	<filter>
		<name>Left landing light motor volts</name>
		<type>gain</type>
		<gain>/controls/circuit-breakers/left-oil-temp-left-landing-light-motor/closed</gain>
		<input>
			<condition>
				<or>
					<and>
						<equals>
							<property>/controls/lighting/landing-light[0]</property>
							<value>1</value>
						</equals>
						<less-than>
							<property>/sim/model/lights/landing[0]/pos-norm</property>
							<value>1</value>
						</less-than>
					</and>
					<and>
						<equals>
							<property>/controls/lighting/landing-light[0]</property>
							<value>-1</value>
						</equals>
						<greater-than>
							<property>/sim/model/lights/landing[0]/pos-norm</property>
							<value>0</value>
						</greater-than>
					</and>
				</or>
			</condition>
			<property>bus/volts</property>
		</input>
		<output>consumers/landing-light-motor[0]/volts</output>
	</filter>
	<filter>
		<name>Left landing light motor amps</name>
		<type>gain</type>
		<input>
			<expression>
				<div>
					<property>consumers/landing-light-motor[0]/volts</property>
					<div>
						<property>consumers/landing-light-motor[0]/rated-volts</property>
						<property>consumers/landing-light-motor[0]/rated-amps</property>
					</div>
				</div>
			</expression>
		</input>
		<output>consumers/landing-light-motor[0]/amps</output>
	</filter>
	
	<filter>
		<name>Right landing light volts</name>
		<type>gain</type>
		<gain>/controls/circuit-breakers/right-landing-light-rear-cigar-lighter/closed</gain>
		<input>
			<condition>
				<property>/sim/equipment/right-landing-light</property>
			</condition>
			<property>bus/volts</property>
			<scale>
				<property>/controls/lighting/landing-light[1]</property>
				<min>0</min>
				<max>1</max>
			</scale>
		</input>
		<output>consumers/landing-light[1]/volts</output>
	</filter>
	<filter>
		<name>Right landing light amps</name>
		<type>gain</type>
		<input>
			<condition>
				<property>/sim/equipment/right-landing-light</property>
			</condition>
			<expression>
				<div>
					<property>consumers/landing-light[1]/volts</property>
					<div>
						<property>consumers/landing-light[1]/rated-volts</property>
						<property>consumers/landing-light[1]/rated-amps</property>
					</div>
				</div>
			</expression>
		</input>
		<output>consumers/landing-light[1]/amps</output>
	</filter>
	
	<filter>
		<name>Right landing light motor volts</name>
		<type>gain</type>
		<gain>/controls/circuit-breakers/right-oil-temp-right-landing-light-motor-taxi-light/closed</gain>
		<input>
			<condition>
				<or>
					<and>
						<equals>
							<property>/controls/lighting/landing-light[1]</property>
							<value>1</value>
						</equals>
						<less-than>
							<property>/sim/model/lights/landing[1]/pos-norm</property>
							<value>1</value>
						</less-than>
					</and>
					<and>
						<equals>
							<property>/controls/lighting/landing-light[1]</property>
							<value>-1</value>
						</equals>
						<greater-than>
							<property>/sim/model/lights/landing[1]/pos-norm</property>
							<value>0</value>
						</greater-than>
					</and>
				</or>
				<property>/sim/equipment/right-landing-light</property>
			</condition>
			<property>bus/volts</property>
		</input>
		<output>consumers/landing-light-motor[1]/volts</output>
	</filter>
	<filter>
		<name>Right landing light motor amps</name>
		<type>gain</type>
		<input>
			<expression>
				<div>
					<property>consumers/landing-light-motor[1]/volts</property>
					<div>
						<property>consumers/landing-light-motor[1]/rated-volts</property>
						<property>consumers/landing-light-motor[1]/rated-amps</property>
					</div>
				</div>
			</expression>
		</input>
		<output>consumers/landing-light-motor[1]/amps</output>
	</filter>
	
	<filter>
		<name>Rotating beacon volts</name>
		<type>gain</type>
		<gain>/controls/circuit-breakers/rotating-beacon/closed</gain>
		<input>
			<property>bus/volts</property>
			<scale>/controls/lighting/beacon</scale>
		</input>
		<output>
			<property>consumers/rotating-beacon/volts</property>
			<property>consumers/rotating-beacon-motor/volts</property>
		</output>
	</filter>
	<filter>
		<name>Rotating beacon amps</name>
		<type>gain</type>
		<input>
			<expression>
				<div>
					<property>consumers/rotating-beacon/volts</property>
					<div>
						<property>consumers/rotating-beacon/rated-volts</property>
						<property>consumers/rotating-beacon/rated-amps</property>
					</div>
				</div>
			</expression>
		</input>
		<output>consumers/rotating-beacon/amps</output>
	</filter>
	<filter>
		<name>Rotating beacon motor amps</name>
		<type>gain</type>
		<input>
			<expression>
				<div>
					<property>consumers/rotating-beacon-motor/volts</property>
					<div>
						<property>consumers/rotating-beacon-motor/rated-volts</property>
						<property>consumers/rotating-beacon-motor/rated-amps</property>
					</div>
				</div>
			</expression>
		</input>
		<output>consumers/rotating-beacon-motor/amps</output>
	</filter>
	
	<filter>
		<name>Flaps motor volts</name>
		<type>gain</type>
		<gain>/controls/circuit-breakers/flaps-motor/closed</gain>
		<input>
			<property>bus/volts</property>
		</input>
		<output>
			<property>consumers/flaps-motor/volts</property>
		</output>
	</filter>
	<filter>
		<name>Flaps motor amps</name>
		<type>gain</type>
		<input>
			<expression>
				<product>
					<div>
						<property>consumers/flaps-motor/volts</property>
						<div>
							<property>consumers/flaps-motor/rated-volts</property>
							<property>consumers/flaps-motor/rated-amps</property>
						</div>
					</div>
					<abs>
						<property>/fdm/jsbsim/systems/flaps/actuator-cmd</property>
					</abs>
				</product>
			</expression>
		</input>
		<output>consumers/flaps-motor/amps</output>
	</filter>
	
	<filter>
		<name>Landing gear motor volts</name>
		<type>gain</type>
		<gain>/controls/circuit-breakers/landing-gear-motor/closed</gain>
		<input>
			<property>bus/volts</property>
		</input>
		<output>
			<property>consumers/landing-gear-motor/volts</property>
		</output>
	</filter>
	<filter>
		<name>Landing gear motor amps</name>
		<type>gain</type>
		<input>
			<expression>
				<product>
					<div>
						<property>consumers/landing-gear-motor/volts</property>
						<div>
							<property>consumers/landing-gear-motor/rated-volts</property>
							<property>consumers/landing-gear-motor/rated-amps</property>
						</div>
					</div>
					<abs>
						<property>/fdm/jsbsim/gear/actuator-cmd</property>
					</abs>
				</product>
			</expression>
		</input>
		<output>consumers/landing-gear-motor/amps</output>
	</filter>
	
	<logic>
		<name>Left starter</name>
		<input>
			<and>
				<property>/controls/engines/engine[0]/starter-button</property>
				<greater-than>
					<property>consumers/starter-motor[0]/volts</property>
					<value>0</value>
				</greater-than>
			</and>
		</input>
		<output>/engines/engine[0]/starter</output>
	</logic>
	
	<logic>
		<name>Right starter</name>
		<input>
			<and>
				<property>/controls/engines/engine[1]/starter-button</property>
				<greater-than>
					<property>consumers/starter-motor[1]/volts</property>
					<value>0</value>
				</greater-than>
			</and>
		</input>
		<output>/engines/engine[1]/starter</output>
	</logic>
	
	<filter>
		<name>Left starter volts</name>
		<type>gain</type>
		<gain>/controls/circuit-breakers/right-fuel-boost-pump-starters/closed</gain>
		<input>
			<property>bus/volts</property>
		</input>
		<output>
			<property>consumers/starter-motor[0]/volts</property>
		</output>
	</filter>
	<filter>
		<name>Left starter amps</name>
		<type>gain</type>
		<input>
			<condition>
				<and>
					<property>/engines/engine[0]/starter</property>
					<not>
						<property>/engines/engine[0]/running</property>
					</not>
				</and>
			</condition>
			<expression>
				<product>
					<div>
						<property>consumers/starter-motor[0]/volts</property>
						<div>
							<property>consumers/starter-motor[0]/rated-volts</property>
							<property>consumers/starter-motor[0]/rated-amps</property>
						</div>
					</div>
				</product>
			</expression>
		</input>
		<output>consumers/starter-motor[0]/amps</output>
	</filter>
	<filter>
		<name>Left starter watts</name>
		<type>gain</type>
		<input>
			<expression>
				<product>
					<property>consumers/starter-motor[0]/volts</property>
					<property>consumers/starter-motor[0]/amps</property>
				</product>
			</expression>
		</input>
		<output>consumers/starter-motor[0]/watts</output>
	</filter>
	
	<filter>
		<name>Right starter volts</name>
		<type>gain</type>
		<gain>/controls/circuit-breakers/right-fuel-boost-pump-starters/closed</gain>
		<input>
			<property>bus/volts</property>
		</input>
		<output>
			<property>consumers/starter-motor[1]/volts</property>
		</output>
	</filter>
	
	<filter>
		<name>Right starter amps</name>
		<type>gain</type>
		<input>
			<condition>
				<and>
					<property>/engines/engine[1]/starter</property>
					<not>
						<property>/engines/engine[1]/running</property>
					</not>
				</and>
			</condition>
			<expression>
				<product>
					<div>
						<property>consumers/starter-motor[1]/volts</property>
						<div>
							<property>consumers/starter-motor[1]/rated-volts</property>
							<property>consumers/starter-motor[1]/rated-amps</property>
						</div>
					</div>
				</product>
			</expression>
		</input>
		<output>consumers/starter-motor[1]/amps</output>
	</filter>
	<filter>
		<name>Right starter watts</name>
		<type>gain</type>
		<input>
			<expression>
				<product>
					<property>consumers/starter-motor[1]/volts</property>
					<property>consumers/starter-motor[1]/amps</property>
				</product>
			</expression>
		</input>
		<output>consumers/starter-motor[1]/watts</output>
	</filter>
	
	<filter>
		<name>Left fuel boost pump volts</name>
		<type>gain</type>
		<gain>/controls/circuit-breakers/left-fuel-boost-pump-oat-gauge/closed</gain>
		<input>
			<expression>
				<product>
					<property>bus/volts</property>
					<property>/controls/engines/engine[0]/fuel-pump</property>
				</product>
			</expression>
		</input>
		<output>
			<property>consumers/fuel-boost-pump[0]/volts</property>
		</output>
	</filter>
	<filter>
		<name>Left fuel boost pump amps</name>
		<type>gain</type>
		<input>
			<expression>
				<product>
					<div>
						<property>consumers/fuel-boost-pump[0]/volts</property>
						<div>
							<property>consumers/fuel-boost-pump[0]/rated-volts</property>
							<property>consumers/fuel-boost-pump[0]/rated-amps</property>
						</div>
					</div>
				</product>
			</expression>
		</input>
		<output>consumers/fuel-boost-pump[0]/amps</output>
	</filter>
	
	<filter>
		<name>Right fuel boost pump volts</name>
		<type>gain</type>
		<gain>/controls/circuit-breakers/right-fuel-boost-pump-starters/closed</gain>
		<input>
			<expression>
				<product>
					<property>bus/volts</property>
					<property>/controls/engines/engine[1]/fuel-pump</property>
				</product>
			</expression>
		</input>
		<output>
			<property>consumers/fuel-boost-pump[1]/volts</property>
		</output>
	</filter>
	<filter>
		<name>Right fuel boost pump amps</name>
		<type>gain</type>
		<input>
			<expression>
				<product>
					<div>
						<property>consumers/fuel-boost-pump[1]/volts</property>
						<div>
							<property>consumers/fuel-boost-pump[1]/rated-volts</property>
							<property>consumers/fuel-boost-pump[1]/rated-amps</property>
						</div>
					</div>
				</product>
			</expression>
		</input>
		<output>consumers/fuel-boost-pump[1]/amps</output>
	</filter>
	
	<filter>
		<name>Turn coordinator volts</name>
		<type>gain</type>
		<gain>/controls/circuit-breakers/left-cht-gauge-turn-and-bank-flap-pos/closed</gain>
		<input>
			<property>bus/volts</property>
		</input>
		<output>
			<property>consumers/turn-coordinator/volts</property>
		</output>
	</filter>
	<filter>
		<name>Turn coordinator amps</name>
		<type>gain</type>
		<input>
			<expression>
				<product>
					<div>
						<property>consumers/turn-coordinator/volts</property>
						<div>
							<property>consumers/turn-coordinator/rated-volts</property>
							<property>consumers/turn-coordinator/rated-amps</property>
						</div>
					</div>
					<!--  https://www.desmos.com/calculator/czzjglqmyh -->
					<difference>
						<value>10</value>
						<product>
							<value>9</value>
							<pow>
								<property>/instrumentation/turn-indicator/spin</property>
								<value>0.1</value>
							</pow>
						</product>
					</difference>
				</product>
			</expression>
		</input>
		<output>consumers/turn-coordinator/amps</output>
	</filter>
	
	<filter>
		<name>Map light volts</name>
		<type>gain</type>
		<!--<gain>/controls/circuit-breakers/left-cht-gauge-turn-and-bank-flap-pos/closed</gain>-->
		<input>
			<property>bus/volts</property>
			<scale>/controls/lighting/map/intensity-norm</scale>
		</input>
		<output>
			<property>consumers/map-light/volts</property>
		</output>
	</filter>
	<filter>
		<name>Map light amps</name>
		<type>gain</type>
		<input>
			<expression>
				<div>
					<property>consumers/map-light/volts</property>
					<div>
						<property>consumers/map-light/rated-volts</property>
						<property>consumers/map-light/rated-amps</property>
					</div>
				</div>
			</expression>
		</input>
		<output>consumers/map-light/amps</output>
	</filter>
	
	<filter>
		<name>Bus amps load</name>
		<type>gain</type>
		<input>
			<expression>
				<sum>
					<property>consumers/nav-lights/amps</property>
					<property>consumers/landing-light[0]/amps</property>
					<property>consumers/landing-light[1]/amps</property>
					<property>consumers/landing-light-motor[0]/amps</property>
					<property>consumers/landing-light-motor[1]/amps</property>
					<property>consumers/rotating-beacon/amps</property>
					<property>consumers/red-instrument-light/amps</property>
					<property>consumers/uv-instrument-light[0]/amps</property>
					<property>consumers/uv-instrument-light[1]/amps</property>
					<property>consumers/front-dome-light/amps</property>
					<property>consumers/rear-dome-light/amps</property>
					<property>consumers/map-light/amps</property>
					<property>consumers/clock-backlight/amps</property>
					<property>consumers/clock/amps</property>
					<property>consumers/flaps-motor/amps</property>
					<property>consumers/landing-gear-motor/amps</property>
					<property>consumers/starter-motor[0]/amps</property>
					<property>consumers/starter-motor[1]/amps</property>
					<property>consumers/fuel-boost-pump[0]/amps</property>
					<property>consumers/fuel-boost-pump[1]/amps</property>
					<property>consumers/stall-warning-horn/amps</property>
					<property>consumers/stall-warning-indicator/amps</property>
					<property>consumers/turn-coordinator/amps</property>
					<property>consumers/test-amps</property>
				</sum>
			</expression>
		</input>
		<output>bus/amps</output>
	</filter>
	
	<filter>
		<name>Alternators amps load</name>
		<type>gain</type>
		<input>
			<condition>
				<greater-than>
					<property>suppliers/alternators/volts</property>
					<value>0</value>
				</greater-than>
			</condition>
			<expression>
				<sum>
					<property>bus/amps</property>
					<property>suppliers/batteries/amps</property>
				</sum>
			</expression>
		</input>
		<output>suppliers/alternators/amps</output>
		<min>0</min>
		<max>
			<condition>
				<property>suppliers/batteries/contactor</property>
			</condition>
			<property>suppliers/alternators/available-amps</property>
		</max>
		<max>9999</max>
	</filter>
	<filter>
		<name>Left alternator amps load</name>
		<type>gain</type>
		<input>
			<condition>
				<greater-than>
					<property>suppliers/alternator[1]/volts</property>
					<value>0</value>
				</greater-than>
			</condition>
			<property>suppliers/alternators/amps</property>
			<scale>0.5</scale>
		</input>
		<input>
			<condition>
				<greater-than>
					<property>suppliers/alternator[0]/volts</property>
					<value>0</value>
				</greater-than>
			</condition>
			<property>suppliers/alternators/amps</property>
		</input>
		<output>suppliers/alternator[0]/amps</output>
	</filter>
	<filter>
		<name>Right alternator amps load</name>
		<type>gain</type>
		<input>
			<condition>
				<greater-than>
					<property>suppliers/alternator[0]/volts</property>
					<value>0</value>
				</greater-than>
			</condition>
			<property>suppliers/alternators/amps</property>
			<scale>0.5</scale>
		</input>
		<input>
			<condition>
				<greater-than>
					<property>suppliers/alternator[1]/volts</property>
					<value>0</value>
				</greater-than>
			</condition>
			<property>suppliers/alternators/amps</property>
		</input>
		<output>suppliers/alternator[1]/amps</output>
	</filter>
	<filter>
		<name>Ground power amps load</name>
		<type>gain</type>
		<input>
			<condition>
				<greater-than>
					<property>suppliers/gpu/volts</property>
					<value>0</value>
				</greater-than>
			</condition>
			<expression>
				<dif>
					<sum>
						<property>bus/amps</property>
						<property>suppliers/batteries/amps</property>
					</sum>
					<property>suppliers/alternators/amps</property>
				</dif>
			</expression>
		</input>
		<output>suppliers/gpu/amps</output>
	</filter>
	<logic>
		<name>Battery contactor</name>
		<input>
			<and>
				<greater-than>
					<property>suppliers/batteries/volts</property>
					<value>0</value>
				</greater-than>
				<greater-than-equals>
					<property>bus/amps</property>
					<property>bus/available-amps</property>
				</greater-than-equals>
			</and>
		</input>
		<output>suppliers/batteries/contactor</output>
	</logic>
	<filter>
		<name>Batteries amps</name>
		<type>gain</type>
		<input>
			<!-- battery has sufficient charge and alternators / ground power are not providing enough voltage - discharge -->
			<condition>
				<property>suppliers/batteries/contactor</property>
			</condition>
			<expression>
				<dif>
					<property>bus/amps</property>
					<property>suppliers/alternators/available-amps</property>
					<property>suppliers/gpu/available-amps</property>
				</dif>
			</expression>
			<min>0</min>
			<max>9999</max>
		</input>
		<input>
			<!-- alternators / ground power are providing enough power - charge -->
			<condition>
				<greater-than>
					<property>bus/volts</property>
					<value>0</value>
				</greater-than>
				<less-than>
					<property>suppliers/batteries/charge-norm</property>
					<value>1</value>
				</less-than>
			</condition>
			<expression>
				<dif>
					<property>bus/amps</property>
					<property>bus/available-amps</property>
				</dif>
			</expression>
			<min>-9999</min>
			<max>0</max>
		</input>
		<output>
			<property>suppliers/batteries/amps</property>
			<property>amps</property>
		</output>
	</filter>
	<filter>
		<name>Left battery amps load</name>
		<type>gain</type>
		<input>
			<condition>
				<less-than>
					<property>suppliers/battery[1]/charge-norm</property>
					<value>1</value>
				</less-than>
				<less-than>
					<property>suppliers/batteries/amps</property>
					<value>0</value>
				</less-than>
			</condition>
			<expression>
				<div>
					<property>suppliers/batteries/amps</property>
					<value>2</value>
				</div>
			</expression>
		</input>
		<input>suppliers/batteries/amps</input>
		<output>suppliers/battery[0]/amps</output>
	</filter>
	<filter>
		<name>Right battery amps load</name>
		<type>gain</type>
		<input>
			<condition>
				<less-than>
					<property>suppliers/battery[0]/charge-norm</property>
					<value>1</value>
				</less-than>
				<less-than>
					<property>suppliers/batteries/amps</property>
					<value>0</value>
				</less-than>
			</condition>
			<expression>
				<div>
					<property>suppliers/batteries/amps</property>
					<value>2</value>
				</div>
			</expression>
		</input>
		<input>suppliers/batteries/amps</input>
		<output>suppliers/battery[1]/amps</output>
	</filter>
	
	<filter>
		<name>Left battery charge in ampere hours</name>
		<type>gain</type>
		<input>
			<expression>
				<dif>
					<property>suppliers/battery[0]/charge-amp_hours</property>
					<div>
						<product>
							<property>suppliers/battery[0]/amps</property>
							<property>/sim/time/delta-sec</property>
						</product>
						<value>3600</value>
					</div>
				</dif>
			</expression>
		</input>
		<output>suppliers/battery[0]/charge-amp_hours</output>
		<min>0</min>
		<max>suppliers/battery[0]/capacity-amp_hours</max>
	</filter>
	<filter>
		<name>Left battery charge normalized</name>
		<type>gain</type>
		<input>
			<expression>
				<div>
					<property>suppliers/battery[0]/charge-amp_hours</property>
					<property>suppliers/battery[0]/capacity-amp_hours</property>
				</div>
			</expression>
		</input>
		<output>suppliers/battery[0]/charge-norm</output>
	</filter>
	
	<filter>
		<name>Right battery charge in ampere hours</name>
		<type>gain</type>
		<input>
			<expression>
				<dif>
					<property>suppliers/battery[1]/charge-amp_hours</property>
					<div>
						<product>
							<property>suppliers/battery[1]/amps</property>
							<property>/sim/time/delta-sec</property>
						</product>
						<value>3600</value>
					</div>
				</dif>
			</expression>
		</input>
		<output>suppliers/battery[1]/charge-amp_hours</output>
		<min>0</min>
		<max>suppliers/battery[1]/capacity-amp_hours</max>
	</filter>
	<filter>
		<name>Right battery charge normalized</name>
		<type>gain</type>
		<input>
			<expression>
				<div>
					<property>suppliers/battery[1]/charge-amp_hours</property>
					<property>suppliers/battery[1]/capacity-amp_hours</property>
				</div>
			</expression>
		</input>
		<output>suppliers/battery[1]/charge-norm</output>
	</filter>
	<filter>
		<name>Batteries charge normalized</name>
		<type>gain</type>
		<input>
			<expression>
				<product>
					<sum>
						<property>suppliers/battery[0]/charge-norm</property>
						<property>suppliers/battery[1]/charge-norm</property>
					</sum>
					<value>0.5</value>
				</product>
			</expression>
		</input>
		<output>suppliers/batteries/charge-norm</output>
	</filter>
	
	<filter>
		<type>gain</type>
		<input>
			<property>/systems/vacuum/directional-gyro-suction-inhg</property>
			<scale>0.2</scale>
		</input>
		<output>outputs/DG</output>
	</filter>
	
	<filter>
		<type>gain</type>
		<input>
			<expression>
				<div>
					<property>consumers/turn-coordinator/volts</property>
					<property>consumers/turn-coordinator/rated-volts</property>
				</div>
			</expression>
		</input>
		<output>outputs/turn-coordinator</output>
	</filter>
</PropertyList>
